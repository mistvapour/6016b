graph TB
    %% API结构图
    
    subgraph "前端界面层 - 第5章"
        REACT_APP["React应用<br/>TypeScript + Vite<br/>📖 5.1.2"]
        PDF_COMP["PDF处理组件<br/>PDFProcessor.tsx<br/>📖 5.2.2"]
        BATCH_COMP["批量处理组件<br/>BatchProcessor.tsx<br/>📖 5.2.5"]
        VIEW_COMP["数据查看组件<br/>TableView.tsx<br/>📖 5.2.5"]
    end
    
    subgraph "API网关层 - 第5章"
        MAIN_GATEWAY["主API网关<br/>main.py<br/>FastAPI应用<br/>📖 5.2.1"]
        CORS["CORS中间件<br/>跨域支持<br/>📖 5.4.2"]
        AUTH["认证中间件<br/>权限控制<br/>📖 5.4.1"]
    end
    
    subgraph "核心API模块 - 第5章"
        PDF_API_MOD["PDF处理API<br/>pdf_api.py<br/>📖 5.2.2"]
        MQTT_API_MOD["MQTT处理API<br/>mqtt_api.py<br/>📖 5.2.3"]
        UNIVERSAL_API_MOD["统一导入API<br/>universal_import_api.py<br/>📖 5.2.5"]
        YAML_API_MOD["YAML导入API<br/>import_yaml.py<br/>📖 5.2.5"]
        CDM_API_MOD["CDM系统API<br/>cdm_api.py<br/>📖 5.2.4"]
        SEMANTIC_API_MOD["语义互操作API<br/>semantic_interop_api.py<br/>📖 5.2.3"]
    end
    
    subgraph "业务逻辑层 - 第4章"
        PDF_LOGIC["PDF处理逻辑<br/>pdf_processor.py<br/>📖 4.3.2(1)"]
        MQTT_LOGIC["MQTT处理逻辑<br/>mqtt_processor.py<br/>📖 4.3.2(2)"]
        UNIVERSAL_LOGIC["统一导入逻辑<br/>universal_import_system.py<br/>📖 4.3.2(4)"]
        CDM_LOGIC["CDM系统逻辑<br/>cdm_system.py<br/>📖 4.3.2(3)"]
        SEMANTIC_LOGIC["语义互操作逻辑<br/>semantic_interop_system.py<br/>📖 4.3.2(2)"]
    end
    
    subgraph "数据访问层 - 第5章"
        DB_LAYER["数据库访问层<br/>db.py<br/>📖 5.1.3"]
        FILE_LAYER["文件访问层<br/>文件系统操作<br/>📖 5.1.3"]
        CACHE_LAYER["缓存访问层<br/>Redis操作<br/>📖 5.1.3"]
    end
    
    subgraph "数据存储 - 第4章"
        PDF_DB[("PDF服务数据库<br/>pdf_service<br/>📖 4.2.4")]
        SEMANTIC_DB[("语义服务数据库<br/>semantic_service<br/>📖 4.2.4")]
        CDM_DB[("CDM服务数据库<br/>cdm_service<br/>📖 4.2.3")]
        IMPORT_DB[("导入服务数据库<br/>import_service<br/>📖 4.2.4")]
        USER_DB[("用户服务数据库<br/>user_service<br/>📖 4.3.2(5)")]
        CONFIG_DB[("配置服务数据库<br/>config_service<br/>📖 4.3.2(5)")]
        MONITOR_DB[("监控服务数据库<br/>monitor_service<br/>📖 5.3.2")]
        FILES["文件系统<br/>PDF/YAML/JSON<br/>📖 5.1.3"]
        REDIS[("Redis缓存<br/>多DB实例<br/>📖 4.5.1")]
    end
    
    %% API路由连接
    REACT_APP --> MAIN_GATEWAY
    PDF_COMP --> PDF_API_MOD
    BATCH_COMP --> UNIVERSAL_API_MOD
    VIEW_COMP --> MAIN_GATEWAY
    
    MAIN_GATEWAY --> CORS
    MAIN_GATEWAY --> AUTH
    MAIN_GATEWAY --> PDF_API_MOD
    MAIN_GATEWAY --> MQTT_API_MOD
    MAIN_GATEWAY --> UNIVERSAL_API_MOD
    MAIN_GATEWAY --> YAML_API_MOD
    MAIN_GATEWAY --> CDM_API_MOD
    MAIN_GATEWAY --> SEMANTIC_API_MOD
    
    %% 业务逻辑连接
    PDF_API_MOD --> PDF_LOGIC
    MQTT_API_MOD --> MQTT_LOGIC
    UNIVERSAL_API_MOD --> UNIVERSAL_LOGIC
    YAML_API_MOD --> UNIVERSAL_LOGIC
    CDM_API_MOD --> CDM_LOGIC
    SEMANTIC_API_MOD --> SEMANTIC_LOGIC
    
    %% 数据访问连接
    PDF_LOGIC --> DB_LAYER
    MQTT_LOGIC --> DB_LAYER
    UNIVERSAL_LOGIC --> DB_LAYER
    CDM_LOGIC --> DB_LAYER
    SEMANTIC_LOGIC --> DB_LAYER
    
    PDF_LOGIC --> FILE_LAYER
    MQTT_LOGIC --> FILE_LAYER
    UNIVERSAL_LOGIC --> FILE_LAYER
    
    UNIVERSAL_LOGIC --> CACHE_LAYER
    CDM_LOGIC --> CACHE_LAYER
    
    %% 数据存储连接
    DB_LAYER --> PDF_DB
    DB_LAYER --> SEMANTIC_DB
    DB_LAYER --> CDM_DB
    DB_LAYER --> IMPORT_DB
    DB_LAYER --> USER_DB
    DB_LAYER --> CONFIG_DB
    DB_LAYER --> MONITOR_DB
    FILE_LAYER --> FILES
    CACHE_LAYER --> REDIS
    
    %% 样式
    classDef frontend fill:#e1f5fe
    classDef gateway fill:#f3e5f5
    classDef api fill:#e8f5e8
    classDef logic fill:#fff3e0
    classDef data fill:#fce4ec
    classDef storage fill:#f1f8e9
    
    class REACT_APP,PDF_COMP,BATCH_COMP,VIEW_COMP frontend
    class MAIN_GATEWAY,CORS,AUTH gateway
    class PDF_API_MOD,MQTT_API_MOD,UNIVERSAL_API_MOD,YAML_API_MOD,CDM_API_MOD,SEMANTIC_API_MOD api
    class PDF_LOGIC,MQTT_LOGIC,UNIVERSAL_LOGIC,CDM_LOGIC,SEMANTIC_LOGIC logic
    class DB_LAYER,FILE_LAYER,CACHE_LAYER data
    class PDF_DB,SEMANTIC_DB,CDM_DB,IMPORT_DB,USER_DB,CONFIG_DB,MONITOR_DB,FILES,REDIS storage
